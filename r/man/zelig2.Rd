% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/zelig2.R
\name{zelig2}
\alias{zelig2}
\title{Estimate a Statistical Model}
\usage{
zelig2(
  formula,
  model,
  data,
  weights = NULL,
  survey_design = NULL,
  ids = NULL,
  strata = NULL,
  fpc = NULL,
  nest = FALSE,
  fixef = NULL,
  vcov_type = "default",
  cluster = NULL,
  bootstrap_n = 500L,
  num = 1000L,
  ...
)
}
\arguments{
\item{formula}{A model formula. For fixed effects, use the \pkg{fixest}
pipe syntax (e.g., \code{y ~ x1 + x2 | fe1 + fe2}).}

\item{model}{Character string naming the model family. One of
\code{"ls"}, \code{"logit"}, \code{"probit"}, \code{"poisson"},
\code{"negbin"}, \code{"gamma"}, \code{"tobit"}, or \code{"quantile"}.
See \code{\link{list_models}}.}

\item{data}{A data frame. Character columns are automatically converted to
factors.}

\item{weights}{Optional frequency / analytic weights. Accepts a numeric
vector, a one-sided formula, or a column-name string.}

\item{survey_design}{An optional \code{\link[survey]{svydesign}} object.
If supplied, a survey-weighted model is fitted.}

\item{ids}{Cluster IDs for automatic survey-design construction (formula
or string).}

\item{strata}{Strata for survey design (formula or string).}

\item{fpc}{Finite population correction (formula or string).}

\item{nest}{Logical; nest clusters within strata? Default \code{FALSE}.}

\item{fixef}{Optional fixed-effects specification. A one-sided formula
(e.g., \code{~ state + year}) or a character vector of variable names.
This is an alternative to including \code{|} in the main formula.}

\item{vcov_type}{Character string specifying the variance--covariance
estimator. One of \code{"default"}, \code{"robust"} (alias for
\code{"HC1"}), \code{"HC0"}--\code{"HC4"}, \code{"cluster"}, or
\code{"bootstrap"}. See \code{\link[sandwich]{vcovHC}}.}

\item{cluster}{Cluster variable for cluster-robust SEs. Accepts a vector,
a one-sided formula, or a column-name string.}

\item{bootstrap_n}{Integer; number of bootstrap replicates when
\code{vcov_type = "bootstrap"} (default 500).}

\item{num}{Integer; number of Monte Carlo simulation draws used by
\code{\link{sim}} (default 1000).}

\item{...}{Additional arguments passed to the model-fitting function.}
}
\value{
An object of class \code{"zelig2"}, a named list containing:
\describe{
\item{formula}{The model formula (linear part if fixed effects used).}
\item{model_name}{Character string model name.}
\item{fit}{The underlying fitted model object.}
\item{coef, vcov}{Coefficients and variance--covariance matrix.}
\item{data}{The (possibly factorized) data frame.}
\item{is_survey, is_fixest}{Logical flags.}
}
}
\description{
The main entry point for the \pkg{zelig2} workflow. Fits a statistical model
and stores all metadata needed for counterfactual analysis via
\code{\link{setx}}, \code{\link{sim}}, and \code{\link{plot.zelig2}}.
}
\details{
\code{zelig2} supports eight model families (see \code{\link{list_models}})
and automatically handles:
\itemize{
\item Character-to-factor conversion for categorical predictors.
\item Survey weights (via \pkg{survey}) with no need for separate model
types.
\item Fixed effects (via \pkg{fixest}) when the formula contains
\code{|} or the \code{fixef} argument is used.
\item Robust, clustered, and bootstrap standard errors (via
\pkg{sandwich}).
}
}
\examples{
# Linear regression
data(mtcars)
z <- zelig2(mpg ~ hp + wt, model = "ls", data = mtcars)
z <- setx(z, hp = 150, wt = 3)
z <- sim(z)
summary(z)

# Logistic regression with robust SEs
z <- zelig2(vs ~ hp + wt, model = "logit", data = mtcars,
            vcov_type = "robust")

# Fixed effects (requires fixest)
z <- zelig2(mpg ~ hp | cyl, model = "ls", data = mtcars)

}
\seealso{
\code{\link{setx}} to set covariate scenarios,
\code{\link{sim}} to simulate quantities of interest,
\code{\link{plot.zelig2}} to visualise results,
\code{\link{summary.zelig2}} for coefficient tables.
}
